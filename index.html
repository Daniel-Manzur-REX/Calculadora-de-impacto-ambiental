<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Impacto Ambiental del Arbolado Urbano</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tinos:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
 <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #dce35b, #45b649);
      color: #333;
    }
    h1 {
      font-family: "Tinos", serif;
      font-weight: 400;
      font-style: normal;
      color: #2e7d32;
      margin-bottom: 1em;
      text-align: center;
      letter-spacing: 1px;
    }
    .container {
      max-width: 800px;
      margin: 3em auto;
      background: #ffffff;
      padding: 2em;
      border-radius: 10px;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.2);
    }
    .entry {
      display: flex;
      flex-wrap: wrap;
      gap: 1em;
      margin-bottom: 1.5em;
      border-bottom: 1px dashed #ccc;
      padding-bottom: 1em;
    }
    .entry label {
      flex: 1 1 100%;
      font-weight: bold;
    }
    select, input {
      flex: 1 1 48%;
      padding: 0.5em;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background: #2e7d32;
      color: #fff;
      border: none;
      padding: 0.75em 1.5em;
      font-size: 1em;
      border-radius: 5px;
      cursor: pointer;
      margin: 0.5em 0.5em 0.5em 0;
      transition: 
       background 0.3s,
       box-shadow 0.3s,
       transform 0.2s;
    }
    button:hover {
      background: #27642a;
      box-shadow: 0 8px 24px rgba(46, 125, 50, 0.2), 0 1.5px 6px rgba(0,0,0,0.08);
      transform: scale(1.05);
    }
    #exportable {
      background: #f1f8e9;
      padding: 2em;
      border-radius: 10px;
      border: 1px solid #c5e1a5;
      margin-top: 2em;
    }
    .result ul {
      list-style-type: none;
      padding-left: 0;
    }
    .result li {
      margin-bottom: 0.5em;
    }
    .proyecciones {
      margin-top: 1em;
      margin-bottom: 1em;
      text-align: center;
    }
    #disclaimer {
      margin-top: 2em;
      font-size: 0.85em;
      color: #777;
      text-align: center;
      line-height: 1.4;
    }
    footer {
      margin-top: 3em;
      width: 100%;
      left: 0;
      right: 0;
      position: relative;
      padding: 1em 0;
      text-align: center;
      background-color: #f8fbff;
      box-sizing: border-box;
      margin-bottom: 3em;
    }
  </style>
</head>
<body>
  <div class="container">   
    <img src="assets/creamos-futuro.png" alt="Logo REX" class="d-block mx-auto" style="max-width: 250px; margin-bottom: 1rem;">
    <h1>Calculadora de Impacto Ambiental - Arbolado Urbano en Nuevo León</h1>
    <div id="especiesContainer"></div>
    <div class="text-center mb-3">   
    <button onclick="agregarEntrada()">Agregar Especie</button>
    <button onclick="calcularImpactoProyecto()">Calcular Proyecto</button>
    </div>

    <div class="proyecciones">
      <button onclick="mostrarProyeccion(1)">1 año</button>
      <button onclick="mostrarProyeccion(5)">5 años</button>
      <button onclick="mostrarProyeccion(10)">10 años</button>
      <button onclick="exportarImagen()">Exportar Imagen</button>
    </div>

    <div id="exportable">
      <div class="result" id="resultado"></div>
      <p id="disclaimer">
        Toda la información presentada es un estimado considerando que los ejemplares adquieran las características plenas de su especie.
      </p>
    </div>
  </div>

  <footer class="footer">
    <small>&copy; 2025 Reforestación Extrema - Todos los derechos reservados</small>
  </footer>

  <script>
    const datosEspecies = {
      alamillo: { nombre: "Alamillo (<i>Populus tremuloides</i>)", co2: 35, o2: 150, temp: 2.5, agua: 1400 },
      anacahuita: { nombre: "Anacahuita (<i>Cordia boissieri</i>)", co2: 18, o2: 120, temp: 1.5, agua: 1000 },
      anacua: { nombre: "Anacua (<i>Ehretia anacua</i>)", co2: 28, o2: 135, temp: 2.4, agua: 1250 },
      barreta: { nombre: "Barreta (<i>Helietta parvifolia</i>)", co2: 16, o2: 112, temp: 1.7, agua: 950 },
      chapote_amarillo: { nombre: "Chapote Amarillo (<i>Casimiroa greggii</i>)", co2: 22, o2: 110, temp: 1.8, agua: 950 },
      chapote_negro: { nombre: "Chapote Negro (<i>Diospyros texana</i>)", co2: 18, o2: 100, temp: 1.5, agua: 800},
      colorin: { nombre: "Colorín (<i>Dermatophyllum secundiflorum</i>)", co2: 18, o2: 100, temp: 1.5, agua: 800 },
      crespon: { nombre: "Crespón (<i>Lagerstroemia indica</i>)", co2: 24, o2: 128, temp: 1.9, agua: 1100 },
      duraznillo: { nombre: "Duraznillo (<i>Cercis canadensis</i>)", co2: 22, o2: 110, temp: 1.8, agua: 950 },
      ebano: { nombre: "Ébano (<i>Ebenopsis ebano</i>)", co2: 22, o2: 130, temp: 2.0, agua: 1100 },
      encino_blanco: { nombre: "Encino Blanco (<i>Quercus canbyi.</i>)", co2: 40, o2: 160, temp: 2.5, agua: 1500 },
      encino_bravo: {nombre: "Encino Bravo (<i>Quercus fusiformis</i>)", co2: 30, o2: 140, temp: 2.3, agua: 1200 },
      encino_roble: { nombre: "Encino Roble (<i>Quercus polymorpha</i>)", co2: 42, o2: 165, temp: 2.6, agua: 1550 },
      fresno: { nombre: "Fresno Plumero (<i>Fraxinus berlandieriana</i>)", co2: 25, o2: 145, temp: 2.2, agua: 1300 },
      hierba_del_potro: { nombre: "Hierba del Potro (<i>Erythrostemon mexicanus</i>)", co2: 22, o2: 120, temp: 1.9, agua: 1000 },
      huizache: { nombre: "Huizache (<i>Acacia farnesiana</i>)", co2: 15, o2: 110, temp: 1.8, agua: 900 },
      limoncillo: {nombre: "Limoncillo (<i>Esenbeckia</i>)", co2: 20, o2: 110, temp: 1.7, agua: 900 },
      mimbre: { nombre: "Mimbre (<i>Chilopsis linearis</i>)", co2: 20, o2: 115, temp: 1.7, agua: 950 },
      mezquite: { nombre: "Mezquite (<i>Prosopis glandulosa</i>)", co2: 30, o2: 140, temp: 2.3, agua: 1200 },
      nogal_nuez_lisa: { nombre: "Nogal Nuez Lisa (<i>Carya illinoinensis</i>)", co2: 35, o2: 150, temp: 2.5, agua: 1300 },
      olmo: { nombre: "Olmo (<i>Ulmus crassifolia</i>)", co2: 30, o2: 140, temp: 2.3, agua: 1200 },
      palo_blanco: { nombre: "Palo Blanco (<i>Celtis laevigata</i>)", co2: 28, o2: 135, temp: 2.4, agua: 1250 },
      pino_piñonero: { nombre: "Pino Piñonero (<i>Pinus cembroides</i>)", co2: 25, o2: 100, temp: 2.0, agua: 1000 },
      retama: { nombre: "Retama (<i>Parkinsonia aculeata</i>)", co2: 20, o2: 100, temp: 1.5, agua: 900 },
      sicomoro: { nombre: "Sicomoro Mexicano (<i>Platanus occidentalis mexicana</i>)", co2: 38, o2: 170, temp: 2.8, agua: 1600 },
      sabino: { nombre: "Sabino (<i>Taxodium mucronatum</i>)", co2: 45, o2: 175, temp: 3.0, agua: 1700 },
      sauce: { nombre: "Sauce (<i>Salix nigra</i>)", co2: 35, o2: 150, temp: 2.5, agua: 1400 },
      tronadora: { nombre: "Tronadora (<i>Tecoma stans</i>)", co2: 14, o2: 105, temp: 1.5, agua: 900 }
    };

    let contador = 0;
    let resultadosPorEspecie = [];
    let total = { co2: 0, o2: 0, agua: 0 };
    let aniosSeleccionados = 1;

function agregarEntrada() {
  const contenedor = document.getElementById('especiesContainer');
  const div = document.createElement('div');
  div.className = 'entry';
  div.id = `entry_${contador}`;
  const opciones = Object.keys(datosEspecies).sort().map(e => `<option value="${e}">${datosEspecies[e].nombre}</option>`).join('');
  div.innerHTML = `
    <label for="especie_${contador}">Especie:</label>
    <select id="especie_${contador}">${opciones}</select>
    <label for="cantidad_${contador}">Cantidad:</label>
    <input type="number" id="cantidad_${contador}" placeholder="Ej. 10" min="1" />
    <button type="button" class="btn btn-danger btn-sm ms-2 eliminar-btn" title="Eliminar esta especie" onclick="eliminarEntrada('entry_${contador}')">❌</button>
  `;
  contenedor.appendChild(div);
  contador++;
}

function eliminarEntrada(id) {
  const entry = document.getElementById(id);
  if (entry) entry.remove();
}

function calcularImpactoProyecto() {
  resultadosPorEspecie = [];
  total = { co2: 0, o2: 0, agua: 0 };
  let entradasValidas = 0;
  for (let i = 0; i < contador; i++) {
    const especieInput = document.getElementById(`especie_${i}`);
    const cantidadInput = document.getElementById(`cantidad_${i}`);
    if (!especieInput || !cantidadInput) continue;

    const especie = especieInput.value;
    const cantidad = parseInt(cantidadInput.value);
    if (!especie || isNaN(cantidad) || cantidad <= 0) continue;

    entradasValidas++;
    const datos = datosEspecies[especie];

    resultadosPorEspecie.push({
      nombre: datos.nombre,
      cantidad,
      co2: datos.co2 * cantidad,
      o2: datos.o2 * cantidad,
      agua: datos.agua * cantidad,
      temp: datos.temp
    });

    total.co2 += datos.co2 * cantidad;
    total.o2 += datos.o2 * cantidad;
    total.agua += datos.agua * cantidad;
  }
  if (entradasValidas === 0) {
    document.getElementById('resultado').innerHTML = '<strong>Por favor, agrega al menos una especie y cantidad válida.</strong>';
    return;
  }
  document.getElementById('especiesContainer').innerHTML = "";
  contador = 0;
  mostrarProyeccion(1);
}

    function mostrarProyeccion(anios) {
      aniosSeleccionados = anios;
      if (resultadosPorEspecie.length === 0) {
        document.getElementById('resultado').innerHTML = '<strong>Primero calcula el proyecto.</strong>';
        return;
      }

      let html = `<h2>Resultados por especie a ${anios} año(s)</h2><ul>`;
      resultadosPorEspecie.forEach(r => {
        html += `<li><strong>${r.nombre}:</strong> ${r.cantidad} árboles → CO₂: ${r.co2 * anios} kg, O₂: ${r.o2 * anios} kg, Agua: ${r.agua * anios} L, Reducción: ${r.temp} °C</li>`;
      });
      html += `</ul><h3>Total del proyecto a ${anios} año(s)</h3><ul>`;
      html += `<li><strong>CO₂ total capturado:</strong> ${(total.co2 * anios).toFixed(1)} kg</li>`;
      html += `<li><strong>O₂ total producido:</strong> ${(total.o2 * anios).toFixed(1)} kg</li>`;
      html += `<li><strong>Agua total interceptada:</strong> ${(total.agua * anios).toLocaleString()} L</li>`;
      html += `</ul>`;

      document.getElementById('resultado').innerHTML = html;
    }

function exportarImagen() {
  const exportable = document.getElementById("exportable");
  html2canvas(exportable).then(canvas => {
    const link = document.createElement("a");
    link.download = "impacto_arbolado.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  });
}

    agregarEntrada();
  </script>
</body>
</html>
